var maze=new Object();
var maze1=new Object();
var maze2=new Object();
var maze3=new Object();
var maze4=new Object();
var solucion;

function preload_tiles(folder) 
{
    var image_list= 
        [
        "/0.png",
        "/1.png",
        "/2.png",
        "/3.png",
        "/4.png",
        "/5.png",
        "/6.png",
        "/7.png",
        "/8.png",
        "/9.png",
        "/10.png",
        "/11.png",
        "/12.png",
        "/13.png",
        "/14.png",
        "/15.png",
        "/guy.png",
        "/end.png"];
    var images = new Array();
    for (i = 0; i < image_list.length; i++) 
    {
        images[i] = new Image();
        images[i].src = folder.concat(image_list[i]);
    }
    return images;
}

var tiles=new Array();
tiles[0]=preload_tiles("Poke1");
tiles[1]=preload_tiles("Water");
tiles[2]=preload_tiles("Lava");
tiles[3]=preload_tiles("Desert");

maze1.data= [ 
    [9,1,1,3,9,1,1,3,9,1],
    [8,0,4,6,8,0,0,2,8,0],
    [8,0,1,1,0,2,8,0,0,2],
    [8,0,4,4,4,6,12,4,4,6],
    [8,2,9,1,1,3,9,1,1,1],
    [8,2,8,0,0,2,8,0,4,4],
    [8,0,0,2,8,2,8,0,1,3],
    [12,4,4,6,8,2,12,4,0,2],
    [9,1,1,1,0,0,1,1,0,2],
    [12,4,4,4,4,4,4,4,4,6]];
maze1.height=maze1.data.length;
maze1.width =maze1.data[0].length;
maze1.start=[0,9];
maze1.end=[4,9];

maze2.data=[
    [9,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,9,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,9,1,1,1],
    [8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,8,0,0,0],
    [8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,8,0,0,0],
    [8,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,2,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,8,0,0,0,0,0,0,0,0,0,0,4,4,4,4,0,0,0,2,8,0,0,0],
    [8,0,0,0,1,1,1,3,9,1,1,1,1,1,1,3,8,0,0,2,9,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,2,8,0,0,2,8,0,0,0,1,1,1,3,8,0,0,2,8,0,0,2],
    [8,0,0,0,0,0,0,2,8,0,0,0,0,0,0,2,8,0,0,2,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,8,0,0,2,8,0,0,0,0,0,0,2,8,0,0,2,8,0,0,2],
    [8,0,0,0,0,0,0,2,8,0,0,0,0,0,0,2,8,0,0,2,8,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,6,12,4,4,6,8,0,0,0,0,0,0,2,8,0,0,2,8,0,0,2],
    [12,4,4,4,0,0,0,2,8,0,0,0,0,0,0,2,8,0,0,2,8,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,12,4,4,4,0,0,0,2,12,4,4,6,8,0,0,2],
    [1,1,1,1,0,0,0,2,8,0,0,2,8,0,0,2,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,9,1,1,1,0,0,0,2,9,1,1,1,0,0,0,2],
    [0,0,0,0,0,0,0,2,8,0,0,2,8,0,0,2,8,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,2,8,0,0,0,0,0,0,2,8,0,0,0,0,0,0,2],
    [0,0,0,0,0,0,0,2,8,0,0,2,8,0,0,2,8,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,8,0,0,2,8,0,0,0,0,0,0,2,8,0,0,0,0,0,0,2],
    [0,0,0,0,4,4,4,6,8,0,0,2,12,4,4,6,12,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,8,0,0,2,12,4,4,4,4,4,4,6,8,0,0,0,4,4,4,6],
    [8,0,0,0,1,1,1,1,0,0,0,2,9,1,1,1,1,1,1,3,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,2,8,0,0,0,1,1,1,1,1,1,1,1,0,0,0,2,9,1,1,3],
    [8,0,0,0,0,0,0,0,0,0,0,2,8,0,0,0,0,0,0,2,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,8,0,2,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,8,0,0,2],
    [8,0,0,0,0,0,0,0,0,0,0,2,8,0,0,0,0,0,0,2,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,8,0,2,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,8,0,0,2],
    [8,0,0,0,4,4,4,4,4,4,4,6,8,0,0,0,0,0,0,2,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,8,0,2,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,6,8,0,0,2],
    [8,0,0,0,1,1,1,1,1,1,1,1,0,0,0,2,8,0,0,2,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,8,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,2],
    [8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,8,0,0,2,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2],
    [8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,8,0,0,2,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2],
    [12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,6,12,4,4,6,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,6]];
maze2.height=maze2.data.length;
maze2.width =maze2.data[0].length;
maze2.start=[9,0];
maze2.end=[0,57];

maze3.data=[
    [0,0,0,6,11,12,0,0,0,0,0,0,0,0,0,0,0,0,0,6,11,12,0,0,0,0,0,0,0,0,0,0,0,0,0,6,11,12,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,6,9,4,7,12,0,0,0,0,0,0,0,0,0,0,0,6,9,4,7,12,0,0,0,0,0,0,0,0,0,0,0,6,13,4,3,12,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,6,13,4,5,1,3,12,0,0,0,0,0,0,0,0,0,6,11,8,5,5,3,12,0,0,0,0,0,0,0,0,0,6,9,5,5,2,11,12,0,0,0,0,0,0,0,0,0,0,0],
    [6,13,1,5,5,6,12,3,12,0,0,0,0,0,0,0,6,11,8,6,9,3,8,7,12,0,0,0,0,0,0,0,6,9,4,3,13,4,4,3,12,0,0,0,0,0,0,0,0,0,0],
    [9,5,6,13,5,5,1,6,11,12,0,0,0,0,0,2,9,2,10,9,2,14,12,1,3,12,0,0,0,0,0,2,9,4,7,12,3,9,3,10,11,12,0,0,0,0,0,0,0,0,0],
    [8,5,5,5,5,3,12,5,2,11,12,0,0,0,0,2,10,10,10,10,12,5,3,10,10,11,12,0,0,0,0,2,10,9,5,5,6,14,10,10,8,3,12,0,0,0,0,0,0,0,0],
    [10,9,5,5,3,12,5,3,12,4,7,12,0,0,0,2,14,10,10,12,5,7,10,10,10,8,7,12,0,0,0,2,10,10,9,5,1,5,2,10,10,12,3,12,0,0,0,0,0,0,0],
    [12,6,13,5,6,9,5,2,9,5,5,3,12,0,0,2,9,6,12,5,5,5,2,10,10,10,9,3,12,0,0,2,14,10,12,3,10,9,6,10,10,11,10,11,12,0,0,0,0,0,0],
    [9,5,5,5,5,6,9,6,10,9,7,8,3,12,0,2,12,5,5,1,5,3,10,10,12,6,10,12,3,12,0,2,9,6,13,2,10,12,7,10,10,10,12,4,3,12,0,0,0,0,0],
    [10,9,5,3,13,3,10,11,10,8,3,10,12,7,12,2,9,5,5,6,11,10,10,12,5,5,6,11,8,7,12,2,8,5,3,14,12,1,5,4,6,12,5,3,10,11,12,0,0,0,0],
    [12,2,11,10,9,6,10,10,10,14,10,12,5,5,3,14,12,1,3,9,6,10,10,9,5,5,5,6,12,5,3,14,12,3,12,5,3,12,7,9,5,5,3,10,10,12,3,12,0,0,0],
    [3,12,2,10,8,5,4,6,10,9,4,3,13,3,10,11,15,14,10,12,5,6,10,10,9,5,5,5,5,3,10,11,15,12,3,11,12,5,5,4,5,3,10,12,4,5,4,3,12,0,0],
    [0,3,14,10,14,9,5,5,6,8,3,12,5,6,10,8,3,15,12,1,5,5,6,12,4,5,5,5,7,10,10,8,7,15,12,2,9,5,5,5,3,14,10,9,3,9,7,10,11,12,0],
    [0,0,3,12,3,10,11,9,3,10,12,5,5,3,10,10,8,3,15,12,3,9,5,3,9,5,5,5,5,2,10,12,5,3,15,14,12,5,5,3,12,5,2,10,10,12,5,4,4,3,12],
    [0,0,0,5,2,10,12,6,10,10,11,9,5,2,14,14,10,8,5,5,2,10,9,6,8,5,5,5,3,10,14,9,5,0,5,5,1,5,7,10,9,3,10,10,12,5,7,9,3,8,5],
    [0,0,6,9,2,10,9,5,2,10,10,10,11,10,9,5,2,14,15,11,12,6,10,11,10,11,9,3,10,12,5,6,9,6,15,13,4,5,3,10,14,10,10,10,13,5,3,10,12,6,9],
    [0,6,11,10,10,10,10,13,2,12,2,10,10,10,12,3,14,15,9,4,5,3,10,10,10,10,10,10,12,3,9,5,6,15,9,5,5,3,10,12,3,12,6,10,9,5,6,8,7,9,0],
    [6,9,2,10,12,6,8,3,12,7,10,10,8,6,9,6,15,11,10,11,9,6,10,10,10,12,6,12,3,10,8,7,15,9,4,3,13,4,4,7,12,5,5,6,8,5,5,6,9,0,0],
    [11,10,10,10,13,5,6,12,5,1,6,10,10,9,6,11,9,2,10,10,12,5,6,12,4,5,5,5,6,10,14,11,11,10,11,12,5,5,5,5,5,5,1,7,10,9,7,9,0,0,0],
    [12,6,10,12,5,5,5,5,3,10,11,10,8,6,9,2,10,14,10,12,5,1,1,5,5,5,3,9,1,6,9,2,10,10,10,9,1,3,13,1,3,11,12,5,4,6,9,0,0,0,0],
    [9,5,4,5,5,5,5,3,10,12,6,10,14,9,0,2,12,3,12,5,3,10,10,9,1,7,10,10,14,9,0,2,10,10,8,6,10,12,5,6,10,8,5,1,7,9,0,0,0,0,0],
    [8,5,5,3,9,5,3,10,10,9,1,6,9,0,0,2,9,4,5,7,10,10,10,10,12,5,4,6,9,0,0,2,10,10,12,3,10,9,5,3,10,10,9,6,9,0,0,0,0,0,0],
    [10,9,7,10,12,7,10,10,10,10,14,9,0,0,0,2,8,5,5,5,6,10,10,10,13,1,7,9,0,0,0,2,10,10,11,10,10,10,13,6,10,10,14,9,0,0,0,0,0,0,0],
    [10,12,3,12,5,3,12,6,8,6,9,0,0,0,0,2,10,13,1,5,3,10,10,10,9,6,9,0,0,0,0,2,10,10,12,6,10,8,5,3,8,6,9,0,0,0,0,0,0,0,0],
    [12,5,4,5,3,12,5,5,6,9,0,0,0,0,0,2,12,5,6,11,10,10,10,8,6,9,0,0,0,0,0,2,12,4,5,5,6,12,3,12,6,9,0,0,0,0,0,0,0,0,0],
    [3,13,1,5,6,13,1,7,9,0,0,0,0,0,0,0,3,13,1,2,10,14,10,14,9,0,0,0,0,0,0,0,3,13,1,1,1,7,8,7,9,0,0,0,0,0,0,0,0,0,0],
    [0,3,12,5,5,1,6,9,0,0,0,0,0,0,0,0,0,3,14,10,10,9,6,9,0,0,0,0,0,0,0,0,0,3,14,10,14,9,6,9,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,3,13,1,6,9,0,0,0,0,0,0,0,0,0,0,0,3,12,0,6,9,0,0,0,0,0,0,0,0,0,0,0,3,12,1,6,9,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,3,14,9,0,0,0,0,0,0,0,0,0,0,0,0,0,3,14,9,0,0,0,0,0,0,0,0,0,0,0,0,0,3,14,9,0,0,0,0,0,0,0,0,0,0,0,0,0]];
maze3.height=maze3.data.length;
maze3.width =maze3.data[0].length;
maze3.start=[14,0];
maze3.end=[14,50];

maze4.data=[ [13,1,3,12,3], [9,6,12,3,10] ,[12,5,3,10,10] ,[3,9,6,10,10] ,[12,6,13,4,6]];
maze4.height=maze4.data.length;
maze4.width =maze4.data[0].length;
maze4.start=[0,3];
maze4.end=[3,0];

var maze_list=[maze1,maze2,maze3,maze4];

function dibujo(){

    var selected_maze=document.getElementById("maze_list").value;
    //document.getElementById("Texto").textContent=selected_maze;
    maze=maze_list[selected_maze];
    maze.height=maze.data.length;
    maze.width=maze.data[0].length;
    var c=document.getElementById("myCanvas");
    c.height=maze.height*32;
    c.width=maze.width*32;
    var c_trayectoria=document.getElementById("trayectoria");
    c_trayectoria.height=maze.height*32;
    c_trayectoria.width=maze.width*32;
    var ctx=c.getContext("2d");

    var c_ancho;
    var c_alto;
    for(c_alto=0;c_alto<maze.height;c_alto++)
    {
        for(c_ancho=0;c_ancho<maze.width;c_ancho++)
        {
            ctx.drawImage(document.getElementById(maze.data[c_alto][c_ancho]),32*c_ancho,32*c_alto);
        }
    }
    //ctx.drawImage(point,72,96)

}

function inicializa(){
    var selected_maze=document.getElementById("maze_list").value;
    var maze=maze_list[selected_maze];
    //var maze=maze_list[0];
    draw_maze(maze);
    draw_start_top_layer(maze);
    //draw_path(maze,solucion);
}

function draw_maze(maze){
    var c_maze=document.getElementById("c_maze"); 
    var ctx_maze=c_maze.getContext("2d");
    c_maze.height=maze.height*32;
    c_maze.width=maze.width*32;
    var c_ancho;
    var c_alto;
    for(c_alto=0;c_alto<maze.height;c_alto++)
    {
        for(c_ancho=0;c_ancho<maze.width;c_ancho++)
        {
            ctx_maze.drawImage(tiles[document.getElementById("tiles_list").value][maze.data[c_alto][c_ancho]],32*c_ancho,32*c_alto);
        }
    }
}

function draw_start_top_layer(maze){
    var c_maze=document.getElementById("c_maze"); 
    var c_top=document.getElementById("c_top"); 
    var ctx_top=c_maze.getContext("2d");

    c_top.height=maze.height*32;
    c_top.width=maze.width*32;
    ctx_top.drawImage(tiles[0][16],32*maze.start[1],32*maze.start[0]);
    ctx_top.drawImage(tiles[0][17],32*maze.end[1],32*maze.end[0]);
}

//solucion=[2,4,4,4,4,6,0,0,0,6,0,6,4,6,4,2,2,4,6,4,6,0];

function draw_path(maze,path){
    var c_maze=document.getElementById("c_maze"); 
    var c_top=document.getElementById("c_top"); 
    var ctx_top=c_maze.getContext("2d");
    var inicio=[maze.start[1]*32+16,maze.start[0]*32+16];
    var actual=inicio;
    var siguiente=[0,0];
    ctx_top.beginPath();
    var i;
    for(i=0;i<path.length;i++){
        ctx_top.moveTo(actual[0],actual[1]);
        switch(path[i]){
            case 0:
                siguiente=[actual[0],actual[1]-32];
                ctx_top.lineTo(siguiente[0],siguiente[1]);
                actual=siguiente;
                break;
            case 1:
                siguiente=[actual[0]+32,actual[1]-32];
                ctx_top.lineTo(siguiente[0],siguiente[1]);
                actual=siguiente;
                break;
            case 2:
                siguiente=[actual[0]+32,actual[1]];
                ctx_top.lineTo(siguiente[0],siguiente[1]);
                actual=siguiente;
                break;
            case 3:
                siguiente=[actual[0]+32,actual[1]+32];
                ctx_top.lineTo(siguiente[0],siguiente[1]);
                actual=siguiente;
                break;
            case 4:
                siguiente=[actual[0],actual[1]+32];
                ctx_top.lineTo(siguiente[0],siguiente[1]);
                actual=siguiente;
                break;
            case 5:
                siguiente=[actual[0]-32,actual[1]+32];
                ctx_top.lineTo(siguiente[0],siguiente[1]);
                actual=siguiente;
                break;
            case 6:
                siguiente=[actual[0]-32,actual[1]];
                ctx_top.lineTo(siguiente[0],siguiente[1]);
                actual=siguiente;
                break;
            case 7:
                siguiente=[actual[0]-32,actual[1]-32];
                ctx_top.lineTo(siguiente[0],siguiente[1]);
                actual=siguiente;
                break;
        }
    }
    ctx_top.strokeStyle="red";
    ctx_top.stroke();
}

function draw_result(solucion){
    var selected_maze=document.getElementById("maze_list").value;
    var maze=maze_list[selected_maze];
    //var maze=maze_list[0];
    draw_path(maze,solucion);
}
